<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

<script>
var game;
var background;
var node;
var Version = "0.0.1.55;"
var versionString;
var aspectRatio;

var config = 
{
    type: Phaser.AUTO,

    // an exeptionally shit fix to a problem.
    // The 3 is arbitrary, but should not be larger than 5.
    width: window.innerWidth*2,
    height: window.innerHeight*2,
	
    scene: 
    {
        preload: preload,
        create: create,
        update: update
    },
	
	
};

// define the game
game = new Phaser.Game(config);


console.log("Clicky Drive Version: "+Version);

function preload ()
{
	 this.load.image('bg', 'assets/Background.png');
	 this.load.image('node', 'assets/gold0.png');
	 

}


function create()
{
	
	background = this.add.image(0,0, 'bg'); // is in 16:9 aspect ratio.
	aspectRatio= background.width/background.height; //  this figures whether that is true.
	node = this.add.sprite(0,0, 'node');
	versionString = this.add.text(0, 0, "Clicky Drive v"+Version, { fontFamily: '"Arial"', fontSize:'12pt', color:'black' });
    versionString.originX=-.5; // make it easier to deal with
	versionString.originY=-.5;
	scaleAll();
	


	//resize listener
	window.addEventListener('resize', () => {scaleAll();});
}

function update()
{
	// let's try to only resize after resizing is done, to prevent lag. Don't do it every frame during user resizing.
	

	
	
	
	
}

function scaleAll()
{
	// not only resize, but maintain aspect ratio, which is 16 by 9.
	game.resize(window.innerWidth, window.innerHeight);
		
    background.x=window.innerWidth/2;
	background.y=window.innerHeight/2;
	
	node.x=window.innerWidth/2;
	node.y=window.innerHeight/2;

	
	
	// dyamically set the scale to the shorter of the two diminsions.
	// wait, that only works if the bg is square.
	// right, okay...
	// so how?
	// Okay, idea
	// figure out the aspect ratio of the window!
	windowAspectRatio = window.innerWidth/window.innerHeight;
	// if it is higher it is too wide, if it is lower it is too high.
	if(windowAspectRatio>aspectRatio)
	{
		// set to height.
		background.setScale(window.innerHeight/background.height);
		node.setScale((window.innerHeight/node.height)*.3);
	}
	else
	{
		background.setScale(window.innerWidth/background.width);
		node.setScale((window.innerWidth/node.width)*.3);
	}
	
	// needs to be at end to prevent death
	versionString.y = background.y -(background.displayHeight/2);
	versionString.x = background.x -(background.displayWidth/2);
	
}


</script>
</body>
<style>
* {
	margin: 0;
	padding: 0;
}
</style>
</html>